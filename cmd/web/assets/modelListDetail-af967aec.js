import{_ as we}from"./NavBack.vue_vue_type_script_setup_true_lang-58dbab99.js";import{ac as ce,i as Te,c as Ce,o as me,U as D,k as p,l as k,m as e,j as t,_ as i,$ as f,n as x,Y as U,W as s,aB as pe,al as ee,am as te,d as H,au as ae,x as F,r as I,aC as Z,av as E,K as De,Z as A,a5 as Me,F as Y,z as _e,a0 as se,aD as ne,D as re,a8 as de}from"./utils-6aed841c.js";import{_ as ie}from"./UiParentCard.vue_vue_type_script_setup_true_lang-b8764ac9.js";import{_ as O,ae as G,e as $e,V as J,a5 as q,ai as Pe}from"./index-deb81728.js";import{V as M}from"./VCol-8dbd2366.js";import{V as W}from"./VRow-502466b8.js";import{C as Se}from"./CustomUpload-7ca84cb5.js";import{_ as Ue}from"./Explain.vue_vue_type_style_index_0_lang-c8728b42.js";import{V as Be}from"./VTextarea-da60a54d.js";import{V as Le,a as Ne,b as Re,c as Ge}from"./VExpansionPanel-45c0b88b.js";import{V as Ee,a as ue}from"./VRadioGroup-5f0ba7e0.js";import{V as Fe}from"./VForm-b8d79b7b.js";import{i as Ae}from"./index-8cd50de6.js";import{V as X}from"./VAlert-ee55b69a.js";import{_ as ze}from"./ConfirmByInput.vue_vue_type_style_index_0_lang-605cd9e2.js";import{_ as fe}from"./ConfirmByClick.vue_vue_type_style_index_0_lang-73c9620c.js";import{_ as qe}from"./DialogLog.vue_vue_type_style_index_0_lang-c868e509.js";import{I as je}from"./IconTerminal2-6df4591a.js";import{V as Ye,a as Je,b as We,c as He}from"./VWindowItem-c97068cd.js";import"./IconInfoCircle-613543d9.js";import"./Confirm-7fec1c1d.js";import"./TextLog-6ec42cdb.js";const z=g=>(ee("data-v-11edd06b"),g=g(),te(),g),Oe=z(()=>s("label",null,"供应",-1)),Qe=z(()=>s("label",null,"类型",-1)),Ke=z(()=>s("label",null,"最长上下文",-1)),Ze=z(()=>s("label",null,"微调",-1)),Xe=z(()=>s("label",null,"参数量",-1)),et={style:{color:"#539bff"}},tt=z(()=>s("label",null,"创建时间",-1)),at=z(()=>s("label",null,"备注",-1)),lt={__name:"ModelListDetailBaseInfo",setup(g){const{loadDictTree:S,getLabels:b}=ce(),o=Te("provideModelListDetail"),c=Ce(()=>o.rawData),n=async()=>{await S(["model_type"])};return me(()=>{n()}),(a,$)=>{const w=D("router-link"),C=D("el-tooltip");return p(),k(W,{class:"my-form waterfall"},{default:e(()=>[t(M,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[t(G,{"hide-details":""},{prepend:e(()=>[Oe]),default:e(()=>[i(" "+f(c.value.providerName),1)]),_:1})]),_:1}),t(M,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[t(G,{"hide-details":""},{prepend:e(()=>[Qe]),default:e(()=>[i(" "+f(x(b)([["model_type",c.value.modelType]])),1)]),_:1})]),_:1}),t(M,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[t(G,{"hide-details":""},{prepend:e(()=>[Ke]),default:e(()=>[i(" "+f(c.value.maxTokens),1)]),_:1})]),_:1}),c.value.isFineTuning?(p(),k(M,{key:0,xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[t(G,{"hide-details":""},{prepend:e(()=>[Ze]),default:e(()=>[t(C,{content:"微调详情",placement:"top"},{default:e(()=>[t(w,{to:"/model/fine-tuning/detail?jobId="+c.value.jobId,class:"link"},{default:e(()=>[i(f(c.value.isFineTuning?"是":""),1)]),_:1},8,["to"])]),_:1})]),_:1})]),_:1})):U("",!0),t(M,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[t(G,{"hide-details":""},{prepend:e(()=>[Xe]),default:e(()=>[s("span",et,f(c.value.parameters)+"B",1)]),_:1})]),_:1}),t(M,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[t(G,{"hide-details":""},{prepend:e(()=>[tt]),default:e(()=>[i(" "+f(x(pe).dateFormat(c.value.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1})]),_:1}),t(M,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[t(G,{"hide-details":""},{prepend:e(()=>[at]),default:e(()=>[i(" "+f(c.value.remark),1)]),_:1})]),_:1})]),_:1})}}},ot=O(lt,[["__scopeId","data-v-11edd06b"]]),L=g=>(ee("data-v-7c045d1f"),g=g(),te(),g),st={class:"mx-auto mt-3",style:{width:"540px"}},nt=L(()=>s("label",{class:"required"},"评测指标",-1)),rt=L(()=>s("label",{class:"required"},"待评测数据集",-1)),dt=L(()=>s("label",{class:"required"},"最大输出序列长度",-1)),it=L(()=>s("label",{class:"required"},"单卡Batch大小",-1)),ut=L(()=>s("label",null,"备注",-1)),ct=L(()=>s("label",null,"调度标签",-1)),mt=L(()=>s("label",null,"k8s集群",-1)),pt=L(()=>s("label",null,"推理类型",-1)),_t=L(()=>s("label",{class:"required"},"CPU数量",-1)),ft=L(()=>s("label",{class:"required"},"GPU数量",-1)),vt={class:"required"},yt=H({__name:"CreatePerformanceEvalPane",emits:["submit"],setup(g,{expose:S,emit:b}){const o=ae(),c=F({operateType:"add"}),n=I(""),a=F({modelId:Number(o.query.jobId),fileId:"",evalTargetType:null,maxLength:512,batchSize:32,remark:"",label:null,k8sCluster:null,inferredType:"",cpu:0,gpu:0,maxGpuMemory:""}),$=b,w=I(),C=I(),v=F({fileId:[l=>!!l||"请选择微调文件"],evalTargetType:[l=>!!l||"请选择评测指标"],maxLength:[l=>!!l||"请输入最大输出序列长度"],batchSize:[l=>!!l||"请输入单卡Batch大小"],cpu:[l=>Z.validNumberInput(l,0,100,"请输入使用CPU数量",!0)],gpu:[l=>Z.validNumberInput(l,0,20,"请输入使用GPU数量",!0)],maxGpuMemory:[l=>Z.validNumberInput(l,1,80,"请输入GPU内存",!0)]}),T=({res:l})=>{l&&(a.fileId=l.fileId,n.value=l.filename)},u=()=>{n.value="",a.fileId=""},_=()=>{a.cpu!==1&&(a.cpu=1),a.gpu!==1&&(a.gpu=1)},y=async({valid:l,errors:r,showLoading:B})=>{if(l){const N={...a};a.inferredType==="cpu"?N.gpu=0:N.cpu=0,N.gpu<2&&delete N.maxGpuMemory;const[m,Q]=await E.post({showLoading:B,showSuccess:!0,url:"/evaluate/create",data:N});Q&&(w.value.hide(),$("submit"))}};return S({show({title:l,operateType:r}){w.value.show({title:l,refForm:C}),c.operateType=r,r=="add"&&(u(),a.evalTargetType=null,a.maxLength=512,a.batchSize=32,a.remark="",a.label=null,a.k8sCluster=null,a.inferredType="",a.cpu=0,a.gpu=0,a.maxGpuMemory="")}}),(l,r)=>{const B=D("Select"),N=D("Pane");return p(),k(N,{ref_key:"refPane",ref:w,onSubmit:y},{default:e(()=>[s("div",st,[t(Fe,{ref_key:"refForm",ref:C,class:"my-form"},{default:e(()=>[t(B,{placeholder:"请选择评测指标",rules:v.evalTargetType,mapDictionary:{code:"model_evaluate_target_type"},modelValue:a.evalTargetType,"onUpdate:modelValue":r[0]||(r[0]=m=>a.evalTargetType=m)},{prepend:e(()=>[nt]),_:1},8,["rules","modelValue"]),a.evalTargetType!=="five"?(p(),k(G,{key:0,rules:v.fileId,modelValue:a.fileId,"onUpdate:modelValue":r[1]||(r[1]=m=>a.fileId=m),"hide-details":"auto"},{prepend:e(()=>[rt]),default:e(()=>[n.value?(p(),k($e,{key:0,closable:"",color:"info","onClick:close":u},{default:e(()=>[i(f(n.value),1)]),_:1})):(p(),k(Se,{key:1,"file-type":[".txt",".json",".jsonl"],isSuffixValid:"",onAfterUpload:T},{trigger:e(()=>[t(J,{color:"info",variant:"outlined"},{default:e(()=>[i("上传文件")]),_:1})]),_:1},8,["file-type"]))]),_:1},8,["rules","modelValue"])):U("",!0),t(q,{type:"number",placeholder:"请输入最大输出序列长度","hide-details":"auto",rules:v.maxLength,modelValue:a.maxLength,"onUpdate:modelValue":r[2]||(r[2]=m=>a.maxLength=m),modelModifiers:{number:!0}},{prepend:e(()=>[dt]),_:1},8,["rules","modelValue"]),t(q,{type:"number",placeholder:"请输入单卡Batch大小","hide-details":"auto",rules:v.batchSize,modelValue:a.batchSize,"onUpdate:modelValue":r[3]||(r[3]=m=>a.batchSize=m),modelModifiers:{number:!0}},{prepend:e(()=>[it]),_:1},8,["rules","modelValue"]),t(Be,{modelValue:a.remark,"onUpdate:modelValue":r[4]||(r[4]=m=>a.remark=m),modelModifiers:{trim:!0},placeholder:"请输入你微调模型的备注",clearable:""},{prepend:e(()=>[ut]),_:1},8,["modelValue"]),t(G,null,{default:e(()=>[t(Le,null,{default:e(()=>[t(Ne,{elevation:"10"},{default:e(()=>[t(Re,{class:"text-h6"},{default:e(()=>[i("高级")]),_:1}),t(Ge,{class:"mt-4",eager:""},{default:e(()=>[t(B,{placeholder:"请选择调度标签","hide-details":!1,mapDictionary:{code:"model_deploy_label"},modelValue:a.label,"onUpdate:modelValue":r[5]||(r[5]=m=>a.label=m)},{prepend:e(()=>[ct]),_:1},8,["modelValue"]),t(B,{placeholder:"请选择k8s集群","hide-details":!1,mapDictionary:{code:"k8s_cluster"},modelValue:a.k8sCluster,"onUpdate:modelValue":r[6]||(r[6]=m=>a.k8sCluster=m)},{prepend:e(()=>[mt]),_:1},8,["modelValue"]),t(Ee,{modelValue:a.inferredType,"onUpdate:modelValue":[r[7]||(r[7]=m=>a.inferredType=m),_],inline:"",color:"primary"},{prepend:e(()=>[pt]),default:e(()=>[t(ue,{label:"CPU",value:"cpu"}),t(ue,{label:"GPU",value:"gpu"})]),_:1},8,["modelValue"]),a.inferredType==="cpu"?(p(),k(q,{key:0,type:"number",placeholder:"请输入使用CPU数量",rules:v.cpu,modelValue:a.cpu,"onUpdate:modelValue":r[8]||(r[8]=m=>a.cpu=m),modelModifiers:{number:!0}},{prepend:e(()=>[_t]),_:1},8,["rules","modelValue"])):U("",!0),a.inferredType==="gpu"?(p(),k(q,{key:1,type:"number",placeholder:"请输入使用GPU数量",rules:v.gpu,modelValue:a.gpu,"onUpdate:modelValue":r[9]||(r[9]=m=>a.gpu=m),modelModifiers:{number:!0}},{prepend:e(()=>[ft]),_:1},8,["rules","modelValue"])):U("",!0),a.gpu>1?(p(),k(q,{key:2,type:"number",placeholder:"请输入GPU内存",rules:v.maxGpuMemory,modelValue:a.maxGpuMemory,"onUpdate:modelValue":r[10]||(r[10]=m=>a.maxGpuMemory=m),modelModifiers:{number:!0},max:"80","hide-details":"auto"},{prepend:e(()=>[s("label",vt,[i("GPU内存 "),t(Ue,null,{default:e(()=>[i("指定每个 GPU 用于存储模型权重的最大内存。这允许它为激活分配更多内存，因此您可以使用更长的上下文长度或更大的批量大小")]),_:1})])]),"append-inner":e(()=>[i(" GiB ")]),_:1},8,["rules","modelValue"])):U("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)])]),_:1},512)}}});const ht=O(yt,[["__scopeId","data-v-7c045d1f"]]);const bt={__name:"GradeRadarChart",setup(g,{expose:S}){const b=I();var o=null;const c=({title:n,radar:a,seriesData:$})=>{o=Ae(b.value);const w=$.map(C=>C.name);o.setOption({title:{text:n},legend:{icon:"circle",data:w},radar:a,series:[{type:"radar",data:$}]})};return De(()=>{o&&(o.dispose(),o=null)}),Pe(b,n=>{o==null||o.resize()}),S({initChart:c}),(n,a)=>(p(),A("div",{ref_key:"refChart",ref:b,class:"chart-item w-100 h-100"},null,512))}},gt=O(bt,[["__scopeId","data-v-8ceb45d1"]]),xt=g=>(ee("data-v-6813598c"),g=g(),te(),g),kt={style:{height:"500px"}},Vt=xt(()=>s("h5",{class:"text-h6 text-capitalize"},"建议进一步操作",-1)),It={class:"text-center mt-1"},wt=H({__name:"ViewEvalDetailPane",setup(g,{expose:S}){const b=I(),o=I(),c=F({currentModelId:null,compare1ModelId:null,compare2ModelId:null}),n=I({}),a=[{key:"current",value:"currentModelId",disabled:!0},{key:"compare1",value:"compare1ModelId",disabled:!1},{key:"compare2",value:"compare2ModelId",disabled:!1}],$=F({id:""}),w=()=>{const v={indicator:[{name:"中文能力",max:10,axisLabel:{show:!0}},{name:"推理能力",max:10},{name:"指令遵从能力",max:10},{name:"创新能力",max:10},{name:"阅读理解",max:10}]},T=[];n.value&&a.forEach(u=>{n.value[u.key].value&&T.push({name:n.value[u.key].name,value:n.value[u.key].value})}),o.value.initChart({title:"",radar:v,seriesData:T})},C=async(v=!1)=>{if(v)return;const[T,u]=await E.post({url:"/evaluate/fivegraph",showLoading:b.value.el,data:{currentModelId:c.currentModelId,compare1ModelId:c.compare1ModelId,compare2ModelId:c.compare2ModelId,currentModelEvaluateId:$.id}});u&&(n.value=u,w())};return S({show({title:v,modelId:T,id:u}){b.value.show({width:900,title:v,hasSubmitBtn:!1}),c.currentModelId=parseInt(T),c.compare1ModelId=null,c.compare2ModelId=null,$.id=u,C()}}),(v,T)=>{const u=D("Select"),_=D("Pane");return p(),k(_,{ref_key:"refPane",ref:b},{default:e(()=>[t(W,null,{default:e(()=>{var y;return[t(M,{cols:(y=n.value.current)!=null&&y.isFineTuning?7:12},{default:e(()=>[s("div",kt,[t(gt,{ref_key:"gradeRadarChartRef",ref:o},null,512)])]),_:1},8,["cols"]),n.value.current&&n.value.current.isFineTuning?(p(),k(M,{key:0,cols:"5"},{default:e(()=>[t(X,{type:n.value.current.riskOver?"error":"success",variant:"tonal"},{default:e(()=>[i("过拟合风险")]),_:1},8,["type"]),t(X,{type:n.value.current.riskUnder?"error":"success",variant:"tonal",class:"mt-4"},{default:e(()=>[i("欠拟合风险")]),_:1},8,["type"]),t(X,{type:"info",variant:"tonal",class:"mt-4"},{default:e(()=>[Vt,s("div",null,f(n.value.current.remind),1)]),_:1})]),_:1})):U("",!0),t(M,{cols:"12"},{default:e(()=>[t(W,null,{default:e(()=>[(p(),A(Y,null,Me(a,l=>t(M,{cols:"4"},{default:e(()=>{var r;return[t(u,{placeholder:"请选择模型",modelValue:c[l.value],"onUpdate:modelValue":B=>c[l.value]=B,disabled:l.disabled,clearable:!1,mapAPI:{url:"/channels/models",data:{pageSize:-1,providerName:"LocalAI",modelType:"text-generation",evalTag:"five"},labelField:"modelName",valueField:"id"},onChange:B=>C(l.disabled)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"]),s("div",It,f((r=n.value[l.key])==null?void 0:r.score),1)]}),_:2},1024)),64))]),_:1})]),_:1})]}),_:1})]),_:1},512)}}});const Tt=O(wt,[["__scopeId","data-v-6813598c"]]),Ct={class:""},Dt={class:"d-flex"},Mt={style:{width:"250px"},class:"mr-4"},$t={style:{width:"250px"}},Pt=s("span",null,"请先部署模型 ",-1),St={key:1,class:"d-flex align-center justify-center"},Ut=["onClick"],Bt=["onClick"],Lt=s("span",{class:"text-primary"},"取消",-1),Nt=s("br",null,null,-1),Rt={class:"text-primary font-weight-black"},Gt=s("br",null,null,-1),Et=H({__name:"TabModelEstimate",props:{showArrange:String,modelTitle:String,providerName:String},setup(g){const S=ae(),{modelName:b,jobId:o}=S.query,{loadDictTree:c,getLabels:n}=ce(),a=I(),$=I(),w=I(),C=I(),v=I(),T=I(),u=F({style:{},formData:{modelName:"",evalTargetType:""},showTooltip:!1,timer:null,tableInfos:{list:[],total:0},currentJobId:""}),_=F({status:null,evalTargetType:null}),y=F({uuid:null}),l=I();_e(u);const r=()=>{$.value.show({title:"性能评估",operateType:"add"})},B=h=>{w.value.show({title:"详情",id:h.id,modelId:o})},N=h=>{u.currentJobId=h.uuid,v.value.show({width:"450px",confirmText:u.currentJobId})},m=h=>{y.uuid=h.uuid,T.value.show({width:"450px"})},Q=async(h={})=>{const[V,P]=await E.delete({...h,showSuccess:!0,url:`/evaluate/delete/${y.uuid}`});P&&(T.value.hide(),oe())},ve=async(h={})=>{const[V,P]=await E.put({...h,showSuccess:!0,url:`/evaluate/cancel/${u.currentJobId}`});P&&(v.value.hide(),oe())},le=async(h={})=>{await c(["model_evaluate_data_type"]);const[V,P]=await E.get({url:"/evaluate/list",showLoading:a.value.el,data:{modelId:o,..._,...h}});P?(u.tableInfos.total=P.total,u.tableInfos.list=P.list||[]):(u.tableInfos.list=[],u.tableInfos.total=0)},K=()=>{a.value.query({page:1})},oe=()=>{a.value.query()},ye=h=>{let V=[];return h.status=="waiting"||h.status=="running"?V.push({text:"取消",color:"",click(){N(h)}}):V.push({text:"删除",color:"error",click(){m(h)}}),V},he=async h=>{u.currentJobId=h.uuid,l.value.show()},be=async()=>{let[h,V]=await E.get({url:`/api/evaluate/${b}/eval-log/${u.currentJobId}`});if(V){const P=Object.keys(V).length===0?"":V;l.value.setContent(P)}};return me(()=>{le()}),(h,V)=>{const P=D("Select"),j=D("el-tooltip"),ge=D("ButtonsInForm"),R=D("el-table-column"),xe=D("router-link"),ke=D("ButtonsInTable"),Ve=D("TableWithPager");return p(),A(Y,null,[s("div",Ct,[t(W,null,{default:e(()=>[t(M,{cols:"12",class:"d-flex justify-space-between align-center",style:{height:"76px"}},{default:e(()=>[s("div",Dt,[s("div",Mt,[t(P,{onChange:K,label:"请选择评估状态",mapDictionary:{code:"model_eval_status"},modelValue:_.status,"onUpdate:modelValue":V[0]||(V[0]=d=>_.status=d)},null,8,["modelValue"])]),s("div",$t,[t(P,{onChange:K,label:"请选择指标",mapDictionary:{code:"model_evaluate_target_type"},modelValue:_.evalTargetType,"onUpdate:modelValue":V[1]||(V[1]=d=>_.evalTargetType=d)},null,8,["modelValue"])])]),t(j,{ref:"tooltipRef",visible:u.showTooltip,"popper-options":{modifiers:[{name:"computeStyles",options:{adaptive:!1,enabled:!1}}]},"auto-close":1,"virtual-ref":C.value,"virtual-triggering":"","popper-class":"singleton-tooltip"},{content:e(()=>[Pt]),_:1},8,["visible","virtual-ref"]),t(ge,null,{default:e(()=>[g.providerName==="LocalAI"?(p(),k(J,{key:0,color:"primary",onClick:r},{default:e(()=>[i("创建评估")]),_:1})):U("",!0)]),_:1})]),_:1}),t(M,{cols:"12"},{default:e(()=>[t(Ve,{onQuery:le,ref_key:"refTableWithPager",ref:a,infos:u.tableInfos},{default:e(()=>[t(R,{label:"指标","min-width":"100px"},{default:e(({row:d})=>[i(f(x(n)([["model_evaluate_target_type",d.evalTargetType]])),1)]),_:1}),t(R,{label:"评估状态","min-width":"120px"},{default:e(({row:d})=>[d.status==="failed"?(p(),k(j,{key:0,content:d.statusMsg,placement:"top","raw-content":""},{default:e(()=>[s("span",{class:se(`text-${x(ne).statusMap[d.status].color}`)},f(x(n)([["model_eval_status",d.status]])),3)]),_:2},1032,["content"])):(p(),A("div",St,[s("span",{class:se(`text-${x(ne).statusMap[d.status].color}`)},f(x(n)([["model_eval_status",d.status]])),3),["running","success"].includes(d.status)?(p(),A("div",{key:0,class:"link ml-1",onClick:Ie=>he(d)},"(日志)",8,Ut)):U("",!0)]))]),_:1}),t(R,{label:"webshell","min-width":"90px"},{default:e(({row:d})=>[d.status==="running"?(p(),k(j,{key:0,content:"进入终端",placement:"top"},{default:e(()=>[t(xe,{class:"link",to:{path:"/model/terminal",query:{modelId:x(o)}},target:"_blank"},{default:e(()=>[t(x(je),{class:"align-top",size:20})]),_:1},8,["to"])]),_:1})):U("",!0)]),_:1}),t(R,{label:"数据量","min-width":"100px"},{default:e(({row:d})=>[i(f(d.dataSize),1)]),_:1}),t(R,{label:"评估数据集","min-width":"120px"},{default:e(({row:d})=>[i(f(x(n)([["model_evaluate_data_type",d.dataType]])),1)]),_:1}),t(R,{label:"平均分","min-width":"100px"},{default:e(({row:d})=>[d.evalTargetType==="five"&&d.score>0?(p(),k(j,{key:0,content:"点击可查看五维图指标详情",placement:"top"},{default:e(()=>[s("span",{class:"link",onClick:Ie=>B(d)},f(d.score),9,Bt)]),_:2},1024)):(p(),A(Y,{key:1},[i(f(d.score),1)],64))]),_:1}),t(R,{label:"备注","min-width":"200px","show-overflow-tooltip":""},{default:e(({row:d})=>[i(f(d.remark),1)]),_:1}),t(R,{label:"创建时间","min-width":"160px"},{default:e(({row:d})=>[i(f(x(pe).dateFormat(d.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),t(R,{label:"操作",width:"80px",fixed:"right"},{default:e(({row:d})=>[t(ke,{buttons:ye(d),onlyOne:""},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1})]),t(qe,{ref_key:"refDialogLog",ref:l,interval:30,onRefresh:be},null,512),t(ze,{ref_key:"refConfirmAbort",ref:v,onSubmit:ve},{text:e(()=>[i(" 此操作将会"),Lt,i("正在进行的模型评估"),Nt,i(" 任务ID："),s("span",Rt,f(u.currentJobId),1),Gt,i(" 你还要继续吗？ ")]),_:1},512),t(fe,{ref_key:"refConfirmDelete",ref:T,onSubmit:Q},{text:e(()=>[i("确定要删除该评估数据？")]),_:1},512),t(ht,{ref_key:"createPerformanceEvalPaneRef",ref:$,onSubmit:K},null,512),t(Tt,{ref_key:"viewEvalDetailPaneRef",ref:w},null,512)],64)}}});const Ft=["innerHTML"],ia=H({__name:"modelListDetail",setup(g){const S=ae(),b=I(),o=F({tabIndex:"2",style:{},formData:{},rawData:{modelName:"",deployStatus:"",providerName:""},confirmByClickInfo:{html:"",action:"",row:{}}}),{style:c,rawData:n,formData:a}=_e(o);re("provideModelListDetail",o),re("provideModelListDetailed",o),(async()=>{let{jobId:_}=S.query,[y,l]=await E.get({showLoading:!0,url:`/api/models/${_}`});l&&(o.rawData=l)})();const w=(_={})=>{let{action:y,row:l}=o.confirmByClickInfo;y=="deploy"?C(l,_):y=="undeploy"&&v(l,_)},C=async(_,y)=>{let[l,r]=await E.post({...y,showSuccess:!0,url:`/api/models/${_.id}/deploy`,data:{...o.formData,id:_.id}});r&&b.value.hide()},v=async(_,y)=>{let[l,r]=await E.post({...y,showSuccess:!0,url:`/api/models/${_.id}/undeploy`,data:{...o.formData,id:_.id}});r&&b.value.hide()},T=()=>{de.assign(o.confirmByClickInfo,{html:"确认部署模型 <span class='text-primary mx-1  font-weight-black'>"+o.rawData.modelName+"</span>吗？",action:"deploy",row:o.rawData}),b.value.show({width:"350px"})},u=()=>{de.assign(o.confirmByClickInfo,{html:"确认卸载模型 <span class='text-primary mx-1  font-weight-black'>"+o.rawData.modelName+"</span>吗？",action:"undeploy",row:o.rawData}),b.value.show({width:"350px"})};return(_,y)=>(p(),A(Y,null,[t(we,{backUrl:"/model/model-list/list"},{default:e(()=>[i("模型详情")]),_:1}),t(ie,{class:"mt-4"},{header:e(()=>[i(" 模型："+f(x(n).modelName),1)]),action:e(()=>[x(n).deployStatus=="success"||x(n).deployStatus=="running"?(p(),k(J,{key:0,flat:"",color:"secondary",onClick:u},{default:e(()=>[i("卸载")]),_:1})):U("",!0),x(n).deployStatus=="failed"?(p(),k(J,{key:1,flat:"",color:"secondary",onClick:T},{default:e(()=>[i("部署")]),_:1})):U("",!0)]),default:e(()=>[t(ot)]),_:1}),t(ie,{class:"mt-5"},{header:e(()=>[t(Ye,{modelValue:o.tabIndex,"onUpdate:modelValue":y[0]||(y[0]=l=>o.tabIndex=l),"align-tabs":"start",color:"primary"},{default:e(()=>[t(Je,{value:2},{default:e(()=>[i("当前模型下的评估列表")]),_:1})]),_:1},8,["modelValue"])]),default:e(()=>[t(We,{modelValue:o.tabIndex,"onUpdate:modelValue":y[1]||(y[1]=l=>o.tabIndex=l)},{default:e(()=>[t(He,{value:2},{default:e(()=>[t(Et,{showArrange:x(n).deployStatus,modelTitle:x(n).modelName,providerName:x(n).providerName},null,8,["showArrange","modelTitle","providerName"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(fe,{ref_key:"refConfirmByClick",ref:b,onSubmit:w},{text:e(()=>[s("div",{innerHTML:o.confirmByClickInfo.html},null,8,Ft)]),_:1},512)],64))}});export{ia as default};
