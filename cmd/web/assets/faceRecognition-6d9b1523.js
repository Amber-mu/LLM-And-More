import{_ as j}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-77b9c177.js";import{_ as R}from"./UiParentCard.vue_vue_type_script_setup_true_lang-f6f68ebc.js";import{C as A}from"./ChipBoolean-31d4ce88.js";import{d as z,x as B,r as _,c as M,U as v,k as i,l as h,m as e,j as t,Z as F,W as r,$ as S,F as N,Y as b,_ as y,a0 as O,av as E,al as J,am as Y,o as Z}from"./utils-7a539270.js";import{V as U}from"./VCol-b16873ba.js";import{V as G}from"./VForm-3af80d80.js";import{V as $}from"./VFileInput-185dd17d.js";import{M as q,V as L,ae as k,_ as H,J as W}from"./index-de28ea06.js";import{V as K}from"./VSlider-1987474d.js";import{V as D}from"./VRow-220780f3.js";const p=V=>(J("data-v-c894368e"),V=V(),Y(),V),X=p(()=>r("label",{class:"required"},"检测类型",-1)),ee=p(()=>r("label",{class:"required"},"检测图片",-1)),te=p(()=>r("label",{class:"required"},"比对图片",-1)),ae={class:"text-center",style:{width:"28px"}},le=p(()=>r("label",{class:"required"},"比对阈值",-1)),oe=p(()=>r("label",null,"检测图片：",-1)),ne=["src"],se=p(()=>r("label",null,"比对图片：",-1)),re=["src"],de=p(()=>r("label",null,"人脸个数：",-1)),ie=p(()=>r("label",null,"比对阈值：",-1)),ue=p(()=>r("label",null,"同一个人：",-1)),ce=z({__name:"CreateRecognitionPane",emits:["submit"],setup(V,{expose:T,emit:C}){const f=C,u=B({operateType:"add"}),g=_(),I=_(),l=B({checkType:null,checkImage:[],baseImage:[],tolerance:.6}),o=_({}),x=_(!1),w=M(()=>{const d={checkImage:"",baseImage:""};return["checkImage","baseImage"].forEach(a=>{l[a]&&l[a].length>0&&(d[a]=URL.createObjectURL(l[a][0]))}),d}),m=async()=>{let{valid:d}=await I.value.validate();if(d){x.value=!0;const[a,s]=await E.upload({url:"/esrgan/face/recognition",data:l});s&&(o.value=s,f("submit")),x.value=!1}};return T({show({title:d,operateType:a,infos:s}){g.value.show({title:d,width:a==="add"?"1000px":"600px",hasSubmitBtn:!1}),u.operateType=a,u.operateType==="add"?(l.checkType=null,l.checkImage=[],l.baseImage=[],l.tolerance=.6,o.value={}):o.value=s}}),(d,a)=>{const s=v("Select"),P=v("Pane");return i(),h(P,{ref_key:"refPane",ref:g},{default:e(()=>[t(D,null,{default:e(()=>[u.operateType==="add"?(i(),h(U,{key:0,cols:"12",md:"7"},{default:e(()=>[t(R,{title:"输入"},{default:e(()=>[t(G,{ref_key:"refForm",ref:I,class:"my-form"},{default:e(()=>[t(s,{placeholder:"请选择检测类型",rules:[n=>!!n||"请选择检测类型"],mapDictionary:{code:"face_check_type"},modelValue:l.checkType,"onUpdate:modelValue":a[0]||(a[0]=n=>l.checkType=n)},{prepend:e(()=>[X]),_:1},8,["rules","modelValue"]),t($,{modelValue:l.checkImage,"onUpdate:modelValue":a[1]||(a[1]=n=>l.checkImage=n),"prepend-icon":null,accept:"image/*",label:"请上传检测图片","hide-details":"auto",variant:"outlined",rules:[n=>n.length>0||"请上传检测图片"]},{prepend:e(()=>[ee]),append:e(()=>[t(q,{src:w.value.checkImage,width:"80px",alt:"previewImageUrl",cover:"",class:"rounded-md align-end text-right"},null,8,["src"])]),_:1},8,["modelValue","rules"]),l.checkType===2?(i(),F(N,{key:0},[t($,{modelValue:l.baseImage,"onUpdate:modelValue":a[2]||(a[2]=n=>l.baseImage=n),"prepend-icon":null,accept:"image/*",label:"请上传比对图片","hide-details":"auto",variant:"outlined",rules:[n=>n.length>0||"请上传比对图片"]},{prepend:e(()=>[te]),append:e(()=>[t(q,{src:w.value.baseImage,width:"80px",alt:"previewImageUrl",cover:"",class:"rounded-md align-end text-right"},null,8,["src"])]),_:1},8,["modelValue","rules"]),t(K,{class:"mx-0",modelValue:l.tolerance,"onUpdate:modelValue":a[3]||(a[3]=n=>l.tolerance=n),color:"primary",max:1,min:0,step:.1,"hide-details":"auto","thumb-label":""},{append:e(()=>[r("div",ae,S(l.tolerance),1)]),prepend:e(()=>[le]),_:1},8,["modelValue"])],64)):b("",!0)]),_:1},512),t(L,{color:"primary",block:"",size:"large",flat:"",loading:x.value,onClick:m},{default:e(()=>[y("开始检测")]),_:1},8,["loading"])]),_:1})]),_:1})):b("",!0),t(U,{class:O({"result-right":u.operateType==="edit"}),cols:"12",md:u.operateType==="add"?5:0},{default:e(()=>[t(R,{title:"输出"},{default:e(()=>[o.value.inputS3Url?(i(),h(k,{key:0},{prepend:e(()=>[oe]),default:e(()=>[r("img",{src:o.value.inputS3Url,width:"200",alt:"检测图片",class:"rounded-md align-end text-right"},null,8,ne)]),_:1})):b("",!0),o.value.outputS3Url?(i(),h(k,{key:1},{prepend:e(()=>[se]),default:e(()=>[r("img",{src:o.value.outputS3Url,width:"200",alt:"比对图片",class:"rounded-md align-end text-right"},null,8,re)]),_:1})):b("",!0),t(k,null,{prepend:e(()=>[de]),default:e(()=>[y(" "+S(o.value.faceNum),1)]),_:1}),o.value.outputS3Url?(i(),h(k,{key:2},{prepend:e(()=>[ie]),default:e(()=>[y(" "+S(o.value.denoiseStrength),1)]),_:1})):b("",!0),l.checkType===2||o.value.outputS3Url?(i(),h(k,{key:3},{prepend:e(()=>[ue]),default:e(()=>[y(" "+S(o.value.isSame===void 0?"":o.value.isSame?"是":"否"),1)]),_:1})):b("",!0)]),_:1})]),_:1},8,["class","md"])]),_:1})]),_:1},512)}}});const pe=H(ce,[["__scopeId","data-v-c894368e"]]),me=["src"],_e=["src"],we=z({__name:"faceRecognition",setup(V){const T=_({title:"人脸检测"}),C=_([{text:"图像服务",disabled:!1,href:"#"},{text:"人脸检测",disabled:!0,href:"#"}]),f=B({list:[],total:0}),u=_(),g=_(),I=m=>{let d=[];return d.push({text:"查看",color:"info",click(){w(m)}}),d},l=async(m={})=>{const[d,a]=await E.get({url:"/esrgan/list",showLoading:g.value.el,data:{modelType:"faceRecognition",...m}});a?(f.list=a.list||[],f.total=a.total):(f.list=[],f.total=0)},o=()=>{g.value.query({page:1})},x=()=>{u.value.show({title:"创建检测",operateType:"add"})},w=m=>{u.value.show({title:"查看",infos:m,operateType:"edit"})};return Z(()=>{l()}),(m,d)=>{const a=v("ButtonsInForm"),s=v("el-table-column"),P=v("ButtonsInTable"),n=v("TableWithPager");return i(),F(N,null,[t(j,{title:T.value.title,breadcrumbs:C.value},null,8,["title","breadcrumbs"]),t(R,null,{default:e(()=>[t(D,null,{default:e(()=>[t(U,{cols:"12",lg:"3",md:"4",sm:"6"},{default:e(()=>[t(a,null,{default:e(()=>[t(L,{color:"primary",onClick:x},{default:e(()=>[y("创建检测")]),_:1})]),_:1})]),_:1}),t(U,{cols:"12"},{default:e(()=>[t(n,{onQuery:l,ref_key:"tableWithPagerRef",ref:g,infos:f},{default:e(()=>[t(s,{label:"检测图片","min-width":"150px"},{default:e(({row:c})=>[t(W,{size:"80",rounded:"md"},{default:e(()=>[r("img",{src:c.inputS3Url,alt:"检测图片",height:"80"},null,8,me)]),_:2},1024)]),_:1}),t(s,{label:"比对图片","min-width":"150px"},{default:e(({row:c})=>[c.outputS3Url?(i(),h(W,{key:0,size:"80",rounded:"md"},{default:e(()=>[r("img",{src:c.outputS3Url,alt:"比对图片",height:"80"},null,8,_e)]),_:2},1024)):(i(),F(N,{key:1},[y(" -- ")],64))]),_:1}),t(s,{label:"人脸个数",prop:"faceNum","min-width":"160px"}),t(s,{label:"比对阈值",prop:"denoiseStrength","min-width":"160px"}),t(s,{label:"是否同一个人","min-width":"120px"},{default:e(({row:c})=>[t(A,{modelValue:c.isSame,"onUpdate:modelValue":Q=>c.isSame=Q},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(s,{label:"操作人",prop:"operatorEmail","min-width":"150px","show-overflow-tooltip":""}),t(s,{label:"操作",width:"80px",fixed:"right"},{default:e(({row:c})=>[t(P,{buttons:I(c),onlyOne:""},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1})]),_:1}),t(pe,{ref_key:"createRecognitionPaneRef",ref:u,onSubmit:o},null,512)],64)}}});export{we as default};
