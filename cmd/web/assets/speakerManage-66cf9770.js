import{d as W,ac as L,x as D,r as k,c as M,U as V,k as x,l as T,m as a,W as d,j as e,_ as p,Z as $,a5 as z,F as Q,av as R,al as J,am as O,o as Z,S as X,aA as ee,Q as ae,$ as S,n as F,aB as le}from"./utils-6aed841c.js";import{_ as te}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-82dacc7b.js";import{_ as oe}from"./UiParentCard.vue_vue_type_script_setup_true_lang-b8764ac9.js";import{A as se}from"./AlertBlock-0bf44731.js";import{_ as re}from"./ConfirmByInput.vue_vue_type_style_index_0_lang-605cd9e2.js";import{_ as ne}from"./AiAudio.vue_vue_type_style_index_0_lang-16b3e1d1.js";import{_ as de}from"./Explain.vue_vue_type_style_index_0_lang-c8728b42.js";import{_ as ue}from"./UploadFile.vue_vue_type_script_setup_true_lang-01134377.js";import{a5 as A,ae as ie,af as pe,J as me,M as ce,_ as _e,V as fe}from"./index-deb81728.js";import{V as ve,a as ke}from"./VRadioGroup-5f0ba7e0.js";import{V as be}from"./VAlert-ee55b69a.js";import{V as ge}from"./VSwitch-7013c67d.js";import{V as Ve}from"./VTextarea-da60a54d.js";import{V as he}from"./VForm-b8d79b7b.js";import{V as ye}from"./VRow-502466b8.js";import{V as C}from"./VCol-8dbd2366.js";import"./IconInfoCircle-613543d9.js";import"./Confirm-7fec1c1d.js";import"./VFileInput-7dcb51a9.js";const _=I=>(J("data-v-cd6f9177"),I=I(),O(),I),xe={class:"mx-auto mt-3",style:{width:"540px"}},Se={class:"required"},Ce=_(()=>d("label",{class:"required"},"标识",-1)),Ie=_(()=>d("label",{class:"required"},"姓名",-1)),we=_(()=>d("label",{class:"required"},"性别",-1)),De=_(()=>d("label",{class:"required"},"年龄段",-1)),Ue=_(()=>d("label",{class:"required"},"语言",-1)),Te=_(()=>d("label",{class:"required"},"风格",-1)),Fe=_(()=>d("label",{class:"required"},"适应范围",-1)),Ne=_(()=>d("label",null,"头像",-1)),Pe=_(()=>d("label",{class:"required"},"启用",-1)),qe=_(()=>d("label",null,"备注",-1)),Be=W({__name:"CreateSpeakerPane",emits:["submit"],setup(I,{expose:N,emit:w}){const U={provider:null,speakName:"",speakCname:"",gender:1,ageGroup:null,lang:null,speakStyle:null,area:null,headImgFileId:"",enabled:!1,remark:""},P=w,{options:f}=L(),m=D({operateType:"add"}),t=k({...U}),i=k(null),h=k(),b=k(),v=D({provider:[n=>!!n||"请选择供应商"],speakName:[n=>!!n||"请输入标识"],speakCname:[n=>!!n||"请输入姓名"],ageGroup:[n=>!!n||"请选择年龄段"],lang:[n=>!!n||"请选择语言"],speakStyle:[n=>!!n||"请选择风格"],area:[n=>!!n||"请选择适应范围"]}),g=M(()=>m.operateType==="edit"),y=M(()=>f.speak_gender),q=()=>{t.value.headImgFileId="",i.value=null},B=async({valid:n,showLoading:o})=>{if(n){const s={url:"",method:""};m.operateType=="add"?(s.url="/voice/speak",s.method="post"):(s.url=`/voice/speak/${t.value.id}`,s.method="put");const[u,l]=await R[s.method]({showLoading:o,showSuccess:!0,url:s.url,data:t.value});l&&(h.value.hide(),P("submit"))}};return N({show({title:n,operateType:o,infos:s}){h.value.show({title:n,refForm:b}),m.operateType=o,m.operateType==="add"?(t.value={...U},i.value=null):(t.value={...s},i.value={s3Url:s.headImg})}}),(n,o)=>{const s=V("Select"),u=V("Pane");return x(),T(u,{ref_key:"refPane",ref:h,onSubmit:B},{default:a(()=>[d("div",xe,[e(he,{ref_key:"refForm",ref:b,class:"my-form"},{default:a(()=>[e(s,{placeholder:"请选择供应商",rules:v.provider,mapDictionary:{code:"speak_provider"},modelValue:t.value.provider,"onUpdate:modelValue":o[0]||(o[0]=l=>t.value.provider=l),disabled:g.value},{prepend:a(()=>[d("label",Se,[p("供应 "),e(de,null,{default:a(()=>[p("供应商指的是外部服务提供，自己有服务请选择Local")]),_:1})])]),_:1},8,["rules","modelValue","disabled"]),e(A,{type:"text",placeholder:"请输入标识","hide-details":"auto",clearable:"",rules:v.speakName,modelValue:t.value.speakName,"onUpdate:modelValue":o[1]||(o[1]=l=>t.value.speakName=l),disabled:g.value},{prepend:a(()=>[Ce]),_:1},8,["rules","modelValue","disabled"]),e(A,{type:"text",placeholder:"请输入姓名","hide-details":"auto",clearable:"",rules:v.speakCname,modelValue:t.value.speakCname,"onUpdate:modelValue":o[2]||(o[2]=l=>t.value.speakCname=l)},{prepend:a(()=>[Ie]),_:1},8,["rules","modelValue"]),e(ve,{"hide-details":"auto",modelValue:t.value.gender,"onUpdate:modelValue":o[3]||(o[3]=l=>t.value.gender=l),inline:"",disabled:g.value},{prepend:a(()=>[we]),default:a(()=>[(x(!0),$(Q,null,z(y.value,l=>(x(),T(ke,{label:l.label,color:"primary",value:l.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue","disabled"]),e(s,{placeholder:"请选择年龄段",rules:v.ageGroup,mapDictionary:{code:"speak_age_group"},modelValue:t.value.ageGroup,"onUpdate:modelValue":o[4]||(o[4]=l=>t.value.ageGroup=l)},{prepend:a(()=>[De]),_:1},8,["rules","modelValue"]),e(s,{placeholder:"请选择语言",rules:v.lang,mapDictionary:{code:"speak_lang"},modelValue:t.value.lang,"onUpdate:modelValue":o[5]||(o[5]=l=>t.value.lang=l),disabled:g.value},{prepend:a(()=>[Ue]),_:1},8,["rules","modelValue","disabled"]),e(s,{placeholder:"请选择风格",rules:v.speakStyle,mapDictionary:{code:"speak_style"},modelValue:t.value.speakStyle,"onUpdate:modelValue":o[6]||(o[6]=l=>t.value.speakStyle=l)},{prepend:a(()=>[Te]),_:1},8,["rules","modelValue"]),e(s,{placeholder:"请选择适应范围",rules:v.area,mapDictionary:{code:"speak_area"},modelValue:t.value.area,"onUpdate:modelValue":o[7]||(o[7]=l=>t.value.area=l)},{prepend:a(()=>[Fe]),_:1},8,["rules","modelValue"]),e(ie,{"hide-details":"auto"},{prepend:a(()=>[Ne]),default:a(()=>[i.value&&i.value.s3Url?(x(),T(be,{key:0,color:"borderColor",variant:"outlined",density:"compact"},{close:a(()=>[e(pe,{class:"text-24 opacity-50 cursor-pointer",color:"textPrimary",onClick:q},{default:a(()=>[p("mdi-close-circle")]),_:1})]),default:a(()=>[e(me,{size:"60"},{default:a(()=>[e(ce,{transition:!1,src:i.value.s3Url,alt:"上传成功后的头像",cover:""},null,8,["src"])]),_:1})]),_:1})):(x(),T(ue,{key:1,accept:"image/*",modelValue:t.value.headImgFileId,"onUpdate:modelValue":o[8]||(o[8]=l=>t.value.headImgFileId=l),infos:i.value,"onUpdate:infos":o[9]||(o[9]=l=>i.value=l),"prepend-icon":null,"prepend-inner-icon":"mdi-camera"},null,8,["modelValue","infos"]))]),_:1}),e(ge,{modelValue:t.value.enabled,"onUpdate:modelValue":o[10]||(o[10]=l=>t.value.enabled=l),color:"primary","hide-details":"auto"},{prepend:a(()=>[Pe]),_:1},8,["modelValue"]),e(Ve,{modelValue:t.value.remark,"onUpdate:modelValue":o[11]||(o[11]=l=>t.value.remark=l),modelModifiers:{trim:!0},placeholder:"请输入备注",clearable:""},{prepend:a(()=>[qe]),_:1},8,["modelValue"])]),_:1},512)])]),_:1},512)}}});const $e=_e(Be,[["__scopeId","data-v-cd6f9177"]]),Re={class:"text-primary font-weight-black"},Ae=d("br",null,null,-1),oa=W({__name:"speakerManage",setup(I){const{loadDictTree:N,getLabels:w}=L();N(["speak_age_group","speak_gender","speak_provider","speak_lang"]);const U=k({title:"发声人管理"}),P=k([{text:"声音合成",disabled:!1,href:"#"},{text:"发声人管理",disabled:!0,href:"#"}]),f=D({speakName:"",provider:null,lang:null}),m=D({list:[],total:0}),t=k(),i=k(),h=k(),b=D({id:"",name:""}),v=s=>{let u=[];return u.push({text:"删除",color:"error",click(){q(s)}}),u.push({text:"编辑",color:"info",click(){o(s)}}),u},g=async(s={})=>{const[u,l]=await R.get({url:"/voice/speak",showLoading:i.value.el,data:{...f,...s}});l?(m.list=l.list||[],m.total=l.total):(m.list=[],m.total=0)},y=()=>{i.value.query({page:1})},q=s=>{b.name=s.speakCname,b.id=s.id,h.value.show({width:"400px",confirmText:b.name})},B=async(s={})=>{const[u,l]=await R.delete({...s,showSuccess:!0,url:`/voice/speak/${b.id}`});l&&(h.value.hide(),g())},n=()=>{t.value.show({title:"添加发声人",operateType:"add"})},o=s=>{t.value.show({title:"编辑发声人",infos:s,operateType:"edit"})};return Z(()=>{g()}),(s,u)=>{const l=V("Select"),Y=V("ButtonsInForm"),c=V("el-table-column"),E=V("router-link"),K=V("ButtonsInTable"),j=V("TableWithPager"),H=X("copy");return x(),$(Q,null,[e(te,{title:U.value.title,breadcrumbs:P.value},null,8,["title","breadcrumbs"]),e(oe,null,{default:a(()=>[e(ye,null,{default:a(()=>[e(C,{cols:"12",lg:"3",md:"4",sm:"6"},{default:a(()=>[e(A,{modelValue:f.speakName,"onUpdate:modelValue":u[0]||(u[0]=r=>f.speakName=r),label:"请输入标识","hide-details":"",clearable:"",onKeyup:ee(y,["enter"]),"onClick:clear":y},null,8,["modelValue","onKeyup"])]),_:1}),e(C,{cols:"12",lg:"3",md:"4",sm:"6"},{default:a(()=>[e(l,{modelValue:f.provider,"onUpdate:modelValue":u[1]||(u[1]=r=>f.provider=r),mapDictionary:{code:"speak_provider"},label:"请选择供应商","hide-details":"",onChange:y},null,8,["modelValue"])]),_:1}),e(C,{cols:"12",lg:"3",md:"4",sm:"6"},{default:a(()=>[e(l,{modelValue:f.lang,"onUpdate:modelValue":u[2]||(u[2]=r=>f.lang=r),mapDictionary:{code:"speak_lang"},label:"请选择语言","hide-details":"",onChange:y},null,8,["modelValue"])]),_:1}),e(C,{cols:"12",lg:"3",md:"4",sm:"6"},{default:a(()=>[e(Y,null,{default:a(()=>[e(fe,{color:"primary",onClick:n},{default:a(()=>[p("添加发声人")]),_:1})]),_:1})]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(se,null,{default:a(()=>[p("修改之后将实时生效，请谨慎操作！")]),_:1})]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(j,{onQuery:g,ref_key:"tableWithPagerRef",ref:i,infos:m},{default:a(()=>[e(c,{label:"标识",width:"150px","show-overflow-tooltip":""},{default:a(({row:r})=>[ae((x(),$("span",null,[p(S(r.speakName),1)])),[[H,r.speakName]])]),_:1}),e(c,{label:"姓名",prop:"speakCname",width:"100px"}),e(c,{label:"供应",width:"100px"},{default:a(({row:r})=>[d("span",null,S(F(w)([["speak_provider",r.provider]])),1)]),_:1}),e(c,{label:"语言",width:"160px"},{default:a(({row:r})=>[d("span",null,S(F(w)([["speak_lang",r.lang]])),1)]),_:1}),e(c,{label:"音色",width:"120px"},{default:a(({row:r})=>[d("div",null,S(F(w)([["speak_age_group",r.ageGroup],["speak_gender",r.gender]],G=>G.length?G.join("")+"声":"未知")),1)]),_:1}),e(c,{label:"试听","min-width":"330px"},{default:a(({row:r})=>[e(ne,{src:r==null?void 0:r.speakDemo},null,8,["src"])]),_:1}),e(c,{label:"部署",width:"100px"},{default:a(({row:r})=>[e(E,{to:{path:"/voice-print/synthesis/synthesis-voice",query:{provider:r.provider,lang:r.lang,speakName:r.speakName}},class:"text-info"},{default:a(()=>[p("合成")]),_:2},1032,["to"])]),_:1}),e(c,{label:"备注",prop:"remark","min-width":"200px"}),e(c,{label:"更新时间","min-width":"160px"},{default:a(({row:r})=>[p(S(F(le).dateFormat(r.updatedAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(c,{label:"操作",width:"120px",fixed:"right"},{default:a(({row:r})=>[e(K,{buttons:v(r)},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1})]),_:1}),e(re,{ref_key:"refConfirmDelete",ref:h,onSubmit:B},{text:a(()=>[p(" 您将要删除"),d("span",Re,S(b.name),1),p("发声人，删除之后该声音将无法继续合成新的声音。"),Ae,p(" 确定要继续吗？ ")]),_:1},512),e($e,{ref_key:"createSpeakerPaneRef",ref:t,onSubmit:y},null,512)],64)}}});export{oa as default};
